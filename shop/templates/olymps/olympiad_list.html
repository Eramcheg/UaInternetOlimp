{% extends "base.html" %}
{% block title %} –û–ª—ñ–º–ø—ñ–∞–¥–∏ —Ç–∞ –∑–∞–≤–¥–∞–Ω–Ω—è - {{ group.title }} {% endblock %}
{% block content %}
<div class="px-4 sm:px-6 lg:px-8 sm:mx-[10%] lg:mx-[20%]">  {# —É–±—Ä–∞–ª–∏ –æ—Ç—Å—Ç—É–ø—ã –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö #}
  <h1 class="text-3xl font-bold text-center text-gray-900 mb-6 sm:mb-8">{{ group.title }}</h1>

  <!-- Year filter -->
  <form method="get" class="mb-6 sm:mb-8 text-center">
    <label for="year" class="mr-2 text-sm text-gray-700">–†—ñ–∫:</label>
    <select id="year" name="year" onchange="this.form.submit()"
            class="rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm shadow-sm focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500">
      <option value="">–í—Å—ñ —Ä–æ–∫–∏</option>
      {% for y in years %}
        <option value="{{ y }}" {% if request.GET.year == y|stringformat:"s" %}selected{% endif %}>{{ y }}</option>
      {% endfor %}
    </select>
  </form>

  <!-- Olympiads list -->
  <div class="space-y-6">
    {% for o in olymps %}
      <div class="flex flex-col md:flex-row gap-4 sm:gap-6 bg-white rounded-xl border border-gray-200 shadow-sm p-3 sm:p-4">

        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="w-full md:w-1/3 bg-gray-50 border border-gray-200 rounded-lg p-3 sm:p-4 flex flex-col justify-center items-center text-center">
          <div class="text-lg sm:text-xl font-semibold text-gray-900">{{ o.year }}</div>
          <div class="text-gray-700 text-sm mt-1">{{ o.name }}</div>
          <div class="text-xs text-gray-500 mt-1 sm:mt-2">
            {% with o.tasks.count as cnt %}
              {% if cnt %}–ó–∞–≤–¥–∞–Ω—å: {{ cnt }}{% else %}–ë–µ–∑ –∑–∞–≤–¥–∞–Ω—å{% endif %}
            {% endwith %}
          </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
        <div class="w-full md:w-2/3 flex flex-col gap-3">
          {% if o.tasks.all %}
            {% for t in o.tasks.all %}
              <div class="p-3 sm:p-4 border border-gray-100 rounded-lg shadow-sm hover:shadow-md transition bg-gray-50">
                <div class="text-sm sm:text-base font-medium text-gray-900 mb-1 sm:mb-2 truncate" title="{{ t.title }}">
                  {{ t.order }}. {{ t.title }}
                </div>

                <div class="flex flex-wrap gap-2">
                  {% if t.tasks_file %}
                    <a href="{{ t.tasks_file.url }}" target="_blank"
                       class="inline-flex items-center rounded-md border border-gray-300 px-2 sm:px-3 py-1 sm:py-1.5 text-xs hover:bg-gray-100">
                      üìÑ –ó–∞–≤–¥–∞–Ω–Ω—è
                    </a>
                  {% else %}
                    <span class="text-xs text-gray-400">üìÑ –∑–∞–≤–¥–∞–Ω–Ω—è —â–µ –Ω–µ –±—É–ª–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ</span>
                  {% endif %}

                  {% if t.solutions_file %}
                    <a href="{{ t.solutions_file.url }}" target="_blank"
                       class="inline-flex items-center rounded-md border border-gray-300 px-2 sm:px-3 py-1 sm:py-1.5 text-xs hover:bg-gray-100">
                      ‚úÖ –†–æ–∑–≤'—è–∑–∫–∏
                    </a>
                  {% else %}
                    <span class="text-xs text-gray-400">‚úÖ —Ä—ñ—à–µ–Ω–Ω—è —â–µ –Ω–µ –±—É–ª–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ</span>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          {% else %}
            <p class="text-sm text-gray-500">–ù–µ–º–∞—î –∑–∞–¥–∞—á –¥–ª—è —Ü—ñ—î—ó –æ–ª—ñ–º–ø—ñ–∞–¥–∏.</p>
          {% endif %}
        </div>
      </div>
    {% empty %}
      <p class="text-gray-600 text-center">–ù–µ–º–∞—î –∑–∞–ø–∏—Å—ñ–≤.</p>
    {% endfor %}
  </div>
</div>
  <!-- Pagination -->
  {% if is_paginated %}
    <nav class="mt-8 flex items-center justify-center gap-6 text-sm">
      {% if page_obj.has_previous %}
        <a class="text-indigo-700 hover:text-indigo-900"
           href="?page={{ page_obj.previous_page_number }}{% if request.GET.year %}&year={{ request.GET.year }}{% endif %}">‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—è</a>
      {% else %}
        <span class="text-gray-300">‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—è</span>
      {% endif %}

      <span class="text-gray-700">–°—Ç–æ—Ä. {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>

      {% if page_obj.has_next %}
        <a class="text-indigo-700 hover:text-indigo-900"
           href="?page={{ page_obj.next_page_number }}{% if request.GET.year %}&year={{ request.GET.year }}{% endif %}">–ù–∞—Å—Ç—É–ø–Ω–∞ ‚Üí</a>
      {% else %}
        <span class="text-gray-300">–ù–∞—Å—Ç—É–ø–Ω–∞ ‚Üí</span>
      {% endif %}
    </nav>
  {% endif %}
</div>
{% endblock %}